[[conspects/calculus/integrals/Критерий Лебега|Критерий Лебега]]

Введём ещё допом:

$D_n[f] = [x \in [a, b]: w_x[f] >= \frac{1}{n}]$

В точке имеется разрыв, когда колебание положительно, но тогда найдётся $n$ такой, что колебание точно больше, чем $1/n$

Тогда $D[f]$ - это просто объединение всех $D_n[f]$

Идея доказательства:
$\Delta_Tf = \sum_i w(x_i - x_{i - 1})$ - должна стремиться к нулю при уменьшении разбиения, но тогда и в сумме должно быть немного. А чтоб это было, то где колебание большое, то сумма длин небольшая, то есть оно имеет лебегову меру 15.

**Достаточность**
Пусть выполнена система из ([[conspects/calculus/integrals/Критерий Лебега|Критерий Лебега]]), то есть функция ограничена, но тогда:
$|f(x)| <= M, \forall x \in [a, b]$

Будем считать, что $M > 0$, иначе доказывать нечего (ну логично, нулевая функция).

Далее, т.к. $D[f]$ имеет лебегову меру 15, то $\forall e > 0, \exists (a_i, b_i)$ - система интервала, такая, что:

1) $D[f] \in$ объединение всех отрезков $(a_i, b_i)$

2) И при этом суммарная длина отрезков меньше, чем $\frac{e}{2M}$ (просто взяли так)

Далее, рассмотрим все точки непрерывности (в них колебание 0), тогда найдём такой малый интервал, что на нём колебание будет достаточно малым (а именно, меньше $\frac{e}{b - a}$)

То есть (строго):

$\forall x \in C[f] : \exists \delta(x) > 0$ т.ч. $w[f]$ (колебание на интервале $(x - 3\delta(x), x + 3\delta(x))$) < $\frac{e}{b - a}$

Теперь, назовём $I(x) = (x - \delta(x), x + \delta(x))$, тогда:

$[a, b] = C[f] + D[f]$ (ну у нас на отрезке либо точки непрерывные, либо разрывные).

Но $C[f]$ мы покрываем всеми интервалами $I(x)$ для всех x. А $D[f]$ мы покрываем интервалами $(a_i, b_i)$, которое, кстати, счётно (не более чем) по кр. Лебега.

Имеем покрытие отрезка $[a, b]$ (оно открыто, т.к. просто интервалы). Далее, по [[Теорема Гейне-Борелля]] (для случая обычного вещественного пространства (очевидно, метрического)).
Можно извлечь конечное подпокрытие $[(c_j, d_j)]_{j = 1}^{L}$ и в нём содержится отрезок.

А теперь зачем нам нужен был Гейне-Борелль - этих интервалов конечное множество и мы можем найти его минимум (из их длин).

Разобъём их на хорошие и плохие интервалы такие, что хорошие - это $I(x)$ (то есть там нет точек разрыва). А плохие - это интервалы из второго семейства.

То есть $\exists \delta = min |c_j - d_j|$ (по всем $j$). Но прикол в чём - эпсилон фиксирован, тогда эта дельта и зависит от эпсилон (а где он - в изначальных отрезках $(a_i, b_i)$ сумма длин которых зависит от эпсилон + от эпсилона зависит $\delta(x)$ для непрерывных).

Тогда возьмём произвольное разбиение [[Определённый интеграл Римана]] $T$ отрезка $[a, b]$
Мелкости $l(T) < \delta(e)$. Ну и пусть это точки $x_i$, а этих точек $N$.

Тогда теперь рассмотрим множество индексов на хорошие и плохие интервальчики.

Более формально $[1, ..., N] = S_g \cup S_b$

$S_g = [i : [x_{i - 1}, x_i] \cap good \ne 0]$ (то есть, что пересечение этого отрезка с хорошим интервалом ненулевое)
$S_b = [i : [x_{i - 1}, x_i] \cap good = 0]$ (то есть все такие i, что отрезок не пересекает хорошие интервалы)
(почему важно именно перечение ОТРЕЗКОВ, а не просто точек - смысл в том, что в силу мелкости разбиения, то у нас отрезок будет содержаться в утроенном, а если мы просто пересекаем точку, то нет).

Возьмём какой-то хороший отрезок i и возьмём из него точку x - точку непрерывности.
Но так как у нас длина этого отрезка меньше, чем $\delta(e)$, то:

$[x_{i - 1}, x_i] \cap (c_j, d_j) = (x - \delta(x), x + \delta(x))$ - идейно прикол в том, что у нас там точно ненулевое пересечение и в этом пересечении у нас точно есть $x$ с какой-то его окрестностью при некотором $x \in C[f]$

Но заметим, что у нас этот отрезок разбиения, содержится в отрезке $(c_j, d_j)$, увеличенном в 3 раза.

Почему это так

$|x_{i} - x_{i - 1}| < \delta(e) = min |c_j - d_j|$ (поэтому если мы типа слева достроим этот же отрезок, то мы точно его поглотим) - а это как раз значит увеличенный в 3 раза отрезок (то есть мы берём длину отрезка и достраиваем отрезок и слева, и справа).

Тогда $[x_i, x_i] \in (x - 3\delta(x), x + 3\delta(x))$ (типа как раз мы увеличиваем в 3 раза отрезок), но тогда:

$w$ (на отрезке $[x_i, x_{i - 1}]$) <= $w$ (на отрезке $(x - 3\delta(x), x + 3\delta(x))) < \frac{e}{b - a}$

Теперь вернёмся к плохим отрезкам, там $w <= 2M$ - очев, просто минимальная и максимальные точки.

Итого: $\Delta_Tf = \sum w[f](x_{i - 1} - x_i) = \sum_{bad_id} + \sum_{good_id} <= \sum \frac{e}{b - a}(x_i - x_{i - 1}) + \sum 2M(x_i - x_{i - 1})$

Далее оценим первое слагаемое: $\sum_{good} \frac{e}{b - a}(x_i - x_{i - 1}) <= e \sum_{all} (x_i - x_{i - 1}) = e$

Плохие индексы - которые не пересекают множество непрерывности, то есть содержатся в множестве разрывности.
А они накрываются $(a_i, b_i)$, но их суммарная длина $< \frac{e}{2M}$! Тогда верна следующая оценка:

$\sum_{bad} <= 2M \sum_{all} |a_i - b_i| <= e$

Тогда $\Delta_Tf < 2e$, то есть мы получили критерий интегрируемости [[Критерий интегрируемости по Риману]]

**Необходимость**

Интегрируема -> выполняются условия, тогда она ограничена ([[Определённый интеграл Римана]]) 
Тогда нужно доказать, что множество $D[f]$ имеет лебегову меру 15.

Так как $D[f]$ - это счётное объединение $D_n[f]$, поэтому нужно доказать, что множество $D_n[f]$ имеет лебегову меру 15 (и тогда для всего объединения всё будет окей по [[Критерий Лебега]])

Зафиксируем сначала $n$ - натуральное.
Воспользуемся элементарным критерием интегрируемости, зафиксируем $e > 0$ и найдём $\delta(e) > 0$, такое $\forall T$ - разбиение $[a, b]$, мелкости $l(T) < \delta(e)$ будет верно, что $\Delta_Tf < \frac{e}{6n}$

Найдём разбиение эквидистантное (состоящее из отрезков одинаковой длины), пусть оно $T = [x_i]_{i = 0}^{N_T}$

Среди отрезков разбиения выберем те, которые пересекают множество $D_n[f]$.

Им будет соответствовать индексное множество $S^{*} \in [1, .., N_T]$

Покажем, что на каждом таком отрезке $\forall i \in S^{*} w_{[x_{i - 1}, x_i]} f >= \frac{1}{2n}$

Случай 1: $x_{i-1} = a \in D_n[f]$ или $x_{i}= b \in D_n[f]$ (на границе отрезка и это самая правая или самая левая точка в отрезке)

$x \in [x_{i-1}, x_{i}] \cap D_n[f]$, тогда $\frac{1}{n}<= w_{x}f <= w_{отрезке}f$

Случай 2: $x \in (x_{i-1}, x_{i}) \cap D_n[f]$ (внутри отрезка)
Вопрос - где может находиться точка, где колебание велико. Она может попасть либо в концевые точки, либо внутрь интервала.
Но тогда $\exists \delta(x) > 0 (x-\delta(x), x + \delta(x)) \in (x_{i-1},x_{i})$
$w_{[x_{i-1}, x_{i}]}f >= w_{(x - \delta(x), x + \delta(x))} >= w_{x}f >= \frac{1}{n}$

Случай 3: $x = x_{i}$ при $x_{i} \ne a, b$, при этом в $x$ большое колебание.

x - является общей граничной точкой для двух отрезков разбиения ($[x_{i-1}, x_{i}]$ и $[x_{i}, x_{i+1}]$)
$x = x_{i} \ne a, b$

Тогда колебание в точке x не превосходит колебания на объединении этих отрезков, но оно оценивается суммой колебаний на каждом из множеств.

$\frac{1}{n} <= w_{x}f <= w_{[x_{i-1}, x_{i + 1}]} <= w_{1}+ w_{2}$ (1, 2 типа на этих двух отрезках)

Далее, либо $w_{1} >= \frac{1}{2n}$, либо $w_{2} >= \frac{1}{2n}$

То есть мы доказали, что $\forall x \in D_{n}[f]$ существует отрезок разбиения такой, что на нём колебания $>= \frac{1}{2n}$
И эти индексы мы и маркируем $S^*$

Тогда:
$\frac{1}{2n}\sum\limits_{i\in S^{*}} |x_{i} - x_{i-1}| <= \sum\limits_{i \in S^*}w(x_{i} - x_{i-1}) <=$ суммой по всем уже отрезкам и их колебаниям (а это уже просто $\Delta_{T}f < \frac{e}{6n}$)

То есть $\sum\limits_{i \in S^{*}} |x_{i} - x_{i-1}| < \frac{e}{3}$
Опять же, теперь оценим все такие $i$, где у нас пересечение с точками разрыва непусто. Но этих точек может быть в 2 раза больше (типа для каждого отрезка у нас точка и в конце, и в начале), поэтому $\sum\limits_{[x_{i-1},x_{i}] \cap D_{n[f]}} |x_{i} - x_{i-1}| < \frac{2e}{3}$
Для любого отрезка всегда можно найти интервал, который его содержит и при этом его длина меньше либо равна $\frac{3}{2}$ длины отрезка.

Получим конечную систему интервалов таких, что сумма их длин $< e$

Необходимость доказана

[[Следствие из критерия Лебега]]
