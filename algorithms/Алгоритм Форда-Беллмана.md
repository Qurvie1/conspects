Рассмотрим отрицательные рёбра в [[Граф|графе]]

Очевидно, что если есть отрицательный цикл, то в целом мы не можем найти путь

Введём массив $dp[v][k]$ - минимальная длина пути от $s$ до $v$, который содержит $\leq k$ рёбер.

Тогда $dp[v][k + 1] = \min(dp[v][k], \min_{(u, v)}(dp[u][k] + w))$

Поскольку в любом простом пути может быть не более, чем $n - 1$ ребро, то после работы алгоритма:

$dist(s, v) = dp[v][n - 1]$

Любой кратчайший путь - простой.

Корректность доказывается как в [[Алгоритм Дейкстры|Дейкстре]] по индукции по числу итераций.

Пусть у нас есть кратчайший путь до вершины $v$:
$v_{0}, v_{1}, ..., v_{n}$

База $k = 0$ - очевидно, так как $d[v_{0}] = d[s] = 0$

После $k$ итерации у нас корректно определён путь $v_{0}, ..., v_{k}$ - он кратчайший

Тогда на $k + 1$ итерации мы отрелаксируем ребро $(v_{k}, v_{k+1})$, то есть $d[v_{k + 1}]$  найдено корректно.

Для поиска отрицательного цикла просто отрелаксируем рёбра ещё один раз. Если же алгоритм не нашёл отрицательный цикл, а он есть, то:
$d[v_{k+1}] \leq d[v_{k}] + w$

Просуммируем по всем неравенствам, тогда сумма весов положительная, но это не верно.
