Хотим оставить как можно меньше рёбер, чтоб граф не потерял связность.

Пусть $G = (V, E)$ - граф, тогда подграф - это просто подмножество вершин и рёбер $H = (V', E')$

Подграф - остовный, если $V = V'$

Задача - найти остовное дерево минимального веса

**Лемма о безопасном ребре**.

Пусть $S$ - остовный подграф $G$, являющийся подмножеством какого-то минимального остовного дерева.

Пусть $C$ - какая-то компонента связности в $S$.

Пусть $e$ - самое дешёвое ребро между $C$ и $V/C$.

Тогда $S + e$ - тоже подграф какого-то минимального остова.

Докажем это утверждение.

Пусть $e = (u, v)$, пусть $T$ - минимальный остов, $S \subset T$.

Предположим, что $e$ не входит в $T$.

Поскольку $T$ - остовное дерево, то есть какой-то путь, соединяющий $u$ и $v$. Когда то граф точно выйдет из $C$ (компоненты связности, где лежит $u$), но в таком случае, пусть это делает ребро $e'$. Это ребро дороже, поэтому если мы его удалим и поставим $e$, то сделаем остов меньшего веса.

**Алгоритм Прима**.

Берём вершину 1, находим самое дешёвое ребро, пусть в вершину 2, потом уже берём самое дешёвое ребро из 1 + 2, пусть в вершину 3 и так далее.

То есть берём самое дешёвое ребро, торчащее из минимального остова.

Корректность следует из леммы.

Можно и за квадрат делать, а можно делать через кучу, как в [[Алгоритм Дейкстры|Дейкстре]].

**Алгоритм Краскала**.

Сначала отсортируем все рёбра в порядке возрастания веса.

В этом порядке рассматриваем рёбра, берём те, которые не добавляют циклов (то есть между несвязными компонентами).

Проверяем всё это с помощью [[DSU]] (лежат ли вершины в одной компоненте)

Тогда сортировка рёбер - $O(m\lg m)$

А проверка для каждого ребра - $O(m \alpha(n))$, где $\alpha(n)$ - обратная функция Аккермана.

**Алгоритм Борувки**.

Для каждой вершины $v$ определим самое дешёвое исходящее из неё ребро, тогда все выбранные рёбра добавляем в миностов. Выделяем и сжимаем компоненты связности. Запустить рекурсивно шаг 1 (поиска рёбер).

Чтоб не было циклов, когда мы выбираем эти рёбра, то из всех рёбер минимального веса нужно выбирать ребро с минимальным номером.

Почему тогда не будет циклов (циклы будут, но длины 2) - потому что тогда если по циклу напишем $e_{1}, e_{2}, e_{3}$ - веса, тогда $e_{1} < e_{2} < e_{3} < e_{1}$ - противоречие.

Тогда поскольку мы каждый раз ищем минимум по рёбрам - $E$ раз, а всего итераций $\leq \lg V$, потому что каждый раз сжимаемся хотя бы в 2 раза, поэтому $O(E\lg V)$ - асимптотика