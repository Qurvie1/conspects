Пусть у нас дан [[Граф|граф]] и неотрицательные веса. Тогда нам нужно по стартовой вершине $s$ найти все $dist(s, v)$

Пока есть нераскрытые вершины (как в [[BFS]]), берём вершину с минимальным $d[v]$ и раскрываем.

В момент раскрытия $v:$ $d[v] = dist(s, v)$

Докажем по индукции по количеству итераций.
База - 1 итерация - очевидно верно.

Переход.
Пусть мы берём вершину $v$ с минимальным $d[v]$.

Рассмотрим кратчайший путь до неё и рассмотрим последнюю раскрытую вершину $x$ на этом пути и, соответственно, следующую нераскрытую - $y$.

Тогда $d[x] = dist(s, x)$ (так как вершина раскрыта и по предположению индукции всё хорошо).

Поскольку мы на кратчайшем пути, то $dist(s, y) = dist(s, x) + w$, $w$ - вес ребра $(x, y)$. Что равно $d[y] = d[x] + w$, потому что мы проводили релаксацию из $x$ (релаксация из $x$ - мы уменьшили расстояние до $y$ + закинули $y$ в кучу).

Но при этом, если $v \ne y$, то такого не может быть, ведь мы выбираем вершину с наименьшим $d[v]$, но у $y$ она меньше.

Поэтому $y = v$ и при этом $d[v] = d[y] = dist(s, y) = dist(s, v)$

Асимптотика

Можно каждый раз находить минимум за $V$, тогда асимптотика будет $O(V^{2})$

Поскольку нам нужно $n$ раз найти минимум и $m$ раз уменьшать значение (делать $decreaseKey$), то нам идеально подходит куча.

Например, бинарная или [[Биномиальная куча|биномиальная]], в идеале - [[Фибоначчиева куча|фибоначчиева]].

Тогда асимптотика будет $O(E\lg V)$ для бинарной и для фибоначчиевой $O(V\lg V + E)$

**Двусторонний алгоритм Дейкстры**

Есть 2 вершинки, нужно найти расстояние между ними, веса неотрицательные. Запускаем 2 Дейкстры.

Останавливаемся, когда какая-то вершина $v$ будет рассмотрена с обеих сторон.

Почему найдём именно корректные пути?

Пусть мы нашли расстояние $d_{s}[v] = k$, а на другом участке не более, чем $k$.

Пусть $dist(s,t) < 2k$ (то есть существует меньший путь).

Но тогда, если $l < k$, то нам подходит просто расстояние до ближайшей вершины $d_{s}[v]$, так как оно точно корректно

Если же наоборот, то найдём первую вершину такую, что её путь $\geq k$, но перед ней у вершины расстояние $< k$, то есть найдено корректно, тогда у этой вершины $u$ путь тоже найден корректно $dist(s, u) = d_{s}[u]$, а поскольку остаток пути длины $< k$, то он тоже корректно находится и равен $d_{t}[u]$

