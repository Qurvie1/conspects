2 вершины называются **сильно связными**, если существует путь в обе стороны. Это отношение эквивалентности.

Сам алгоритм.
1) Получим перестановку вершин в порядке убывания $tout$ как [[Топологическая сортировка|тут]].
2) Красим всё в белый
3) В порядке перестановки из 1 пункта запускаем [[Граф|dfs]] на реверснутом графе (с инвертированными рёбрами) и получим как раз таки компоненту сильной связности

Вопрос - а не обойдём мы лишнего? Докажем, что нет.

**Утверждение**. Пусть $C_{1}, C_{2}$ - две компоненты сильной связности, пусть есть хотя бы одно ребро $C_{1} \rightarrow C_{2}$.

Тогда:
$$
\max_{v\in C_{1}} tout[v] > \max_{u \in C_{2}} tout[u]
$$
(ну достаточно очевидно, если запускаемся из вершины в $C_{2}$, то обойдём всю $C_{2}$ и только потом $C_{1}$. Если из $C_{1}$, то мы сначала зайдём в $C_{2}$, а потом уже закончим всё $C_{1}$).

В чём идея и зачем это вообще, если у нас максимум в $C_{1}$ достигается на какой-то вершине $v$ тогда она будет стоять в перестановке раньше. И когда мы уже будем запускаться на реверснутом графе, то вся $C_{1}$ у нас будет готова и мы туда не пойдём, а закончимся на $C_{2}$.

**Доказательство**. Среди всех вершин $C_{1}$ и $C_{2}$ выберем вершину с минимальным $tin$.

1) Пусть $x \in C_{1}$. Тогда по [[Граф|лемме о белых путях]] мы посетим все вершины и в $C_{1}$, и в $C_{2}$ и только тогда выйдем из $x$, поэтому $tout[x]$ будет максимальным.
2) Пусть $x \in C_{2}$. К моменту $tout[x]$ по [[Граф|лемме о белых путях]] у нас все вершины из $C_{2}$ перекрасятся в чёрный. А $C_{1}$ останется белой, потому что в $C_{1}$ даже пути из $C_{2}$ нет.

Следствие. 
Пусть $id[v]$ - номер КСС, содержащей вершину $v$ в том порядке, в котором находит алгоритм Косарайю.
Пусть $(a, b)$ - ребро в графе, тогда $id[a] \leq id[b]$.

Если в одной КСС, то всё понятно. Если в разных, то это ровно ситуация выше, поэтому сначала обойдётся КСС из $a$, а потом уже обойдётся КСС из $b$.
