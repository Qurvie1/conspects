**Определение**. Слоистая сеть - запускаем [[BFS]] как в [[Эдмондс-Карп|Эдмондсе-Карпе]], только разбиваем вершины на расстоянии 1, 2, 3 и так далее.

Более формально $V_{i} = (v | dist(s, v) = i)$

**Определение.** Пусть $G$ - cеть. Блокирующий [[Потоки|поток]] - такой поток в $G$, который нельзя увеличить без использования обратных рёбер.

Теперь сам алгоритм.

В остаточной сети строит слоистую и находит блокирующий поток. 

Как находим блокирующий поток? Запускаем просто [[Граф|DFS]] и пока мы можем найти поток по первому ребру, то проталкиваем, когда он закончился, то просто увеличиваем указатель (удаляем ребро).

Корректность из [[Форд-Фалкерсон|теоремы Форда-Фалкерсона]].

Сколько раз нужно перестроить слоистую сеть? Не более $V$ раз, так как постоянно увеличивается расстояние от $s$ до $t$.

Поиск пути занимает $V$, так как переходим от слоя к слою.

Всего путей $E$, поскольку каждый путь находить хотя бы одно критическое ребро.

Итого асимптотика $O(V^{2}E)$