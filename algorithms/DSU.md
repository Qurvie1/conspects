–°–∏—Å—Ç–µ–º–∞ –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏—Ö—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤ (–∞–Ω–≥–ª.¬†_disjoint set union_) ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –æ–±—ä–µ–¥–∏–Ω—è—Ç—å –Ω–µ–ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –∏ –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Ä–∞–∑–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ –Ω–∏—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä ¬´–Ω–∞—Ö–æ–¥—è—Ç—Å—è –ª–∏ —ç–ª–µ–º–µ–Ω—Ç—ã¬†ùëéa¬†–∏¬†ùëèb¬†–≤ –æ–¥–Ω–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ¬ª –∏ ¬´—á–µ–º—É —Ä–∞–≤–µ–Ω —Ä–∞–∑–º–µ—Ä –¥–∞–Ω–Ω–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞¬ª.

–ë–æ–ª–µ–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ, –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ –∏–º–µ–µ—Ç—Å—è¬†ùëõn¬†—ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–∞–∂–¥—ã–π –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º (—Å–≤–æ—ë–º —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ–º) –º–Ω–æ–∂–µ—Å—Ç–≤–µ. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–≤–µ –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏:

- –û–±—ä–µ–¥–∏–Ω–∏—Ç—å –¥–≤–∞ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞.
- –ó–∞–ø—Ä–æ—Å–∏—Ç—å, –≤ –∫–∞–∫–æ–º –º–Ω–æ–∂–µ—Å—Ç–≤–µ —Å–µ–π—á–∞—Å –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —É–∫–∞–∑–∞–Ω–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç.

–û–±–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤ —Å—Ä–µ–¥–Ω–µ–º¬†_–ø–æ—á—Ç–∏_¬†–∑–∞¬†ùëÇ(1)O(1)¬†(–Ω–æ –Ω–µ —Å–æ–≤—Å–µ–º).

–ú–Ω–æ–∂–µ—Å—Ç–≤–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –º—ã –±—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –≤ –≤–∏–¥–µ –¥–µ—Ä–µ–≤—å–µ–≤: –æ–¥–Ω–æ –¥–µ—Ä–µ–≤–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–¥–Ω–æ–º—É –º–Ω–æ–∂–µ—Å—Ç–≤—É. –ö–æ—Ä–µ–Ω—å –¥–µ—Ä–µ–≤–∞ ‚Äî —ç—Ç–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å (–ª–∏–¥–µ—Ä) –º–Ω–æ–∂–µ—Å—Ç–≤–∞. –î–ª—è –∫–æ—Ä–Ω–µ–π –¥–µ—Ä–µ–≤—å–µ–≤ –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ –∏—Ö –ø—Ä–µ–¥–∫–∏ ‚Äî –æ–Ω–∏ —Å–∞–º–∏.

–°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–≤–∏–¥—ë–º –∏–¥–µ–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏, –∞ –ø–æ—Ç–æ–º –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç.

**–≠–≤—Ä–∏—Å—Ç–∏–∫–∞ —Å–∂–∞—Ç–∏—è –ø—É—Ç–∏**. –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ–º —Ä–∞–±–æ—Ç—É —Ñ—É–Ω–∫—Ü–∏–∏¬†`leader`. –î–∞–≤–∞–π—Ç–µ –ø–µ—Ä–µ–¥ —Ç–µ–º, –∫–∞–∫ –≤–µ—Ä–Ω—É—Ç—å –æ—Ç–≤–µ—Ç, –∑–∞–ø–∏—à–µ–º –µ–≥–æ –≤¬†`p`¬†–æ—Ç —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—à–∏–Ω—ã, —Ç–æ –µ—Å—Ç—å –ø–µ—Ä–µ–ø–æ–¥–≤–µ—Å–∏–º –µ–≥–æ –∑–∞ —Å–∞–º—É—é –≤—ã—Å–æ–∫—É—é.

```cpp
int leader(int v) {
    return (p[v] == v) ? v : p[v] = leader(p[v]);
}
```

**–†–∞–Ω–≥–æ–≤–∞—è —ç–≤—Ä–∏—Å—Ç–∏–∫–∞**. –ë—É–¥–µ–º —Ö—Ä–∞–Ω–∏—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –µ—ë¬†_—Ä–∞–Ω–≥_¬†‚Äî –≤—ã—Å–æ—Ç—É –µ—ë –ø–æ–¥–¥–µ—Ä–µ–≤–∞. –ü—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏ –¥–µ—Ä–µ–≤—å–µ–≤ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å –∫–æ—Ä–Ω–µ–º –Ω–æ–≤–æ–≥–æ –¥–µ—Ä–µ–≤–∞ —Ç—É –≤–µ—Ä—à–∏–Ω—É, —É –∫–æ—Ç–æ—Ä–æ–π —Ä–∞–Ω–≥ –±–æ–ª—å—à–µ, –∏ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å —Ä–∞–Ω–≥–∏ (—Ä–∞–Ω–≥ —É –ª–∏–¥–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏—Ç—å—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É, –µ—Å–ª–∏ –æ–Ω —Å–æ–≤–ø–∞–¥–∞–ª —Å —Ä–∞–Ω–≥–æ–º –¥—Ä—É–≥–æ–π –≤–µ—Ä—à–∏–Ω—ã). –≠—Ç–∞ —ç–≤—Ä–∏—Å—Ç–∏–∫–∞ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –≤—ã—Å–æ—Ç—É –¥–µ—Ä–µ–≤–∞ –Ω–∞–ø—Ä—è–º—É—é.

```cpp
void unite(int a, int b) {
    a = leader(a), b = leader(b);
    if (h[a] > h[b])
        swap(a, b);
    h[b] = max(h[b], h[a] + 1);
    p[a] = b;
}
```

–≠–≤—Ä–∏—Å—Ç–∏–∫–∞ —Å–∂–∞—Ç–∏—è –ø—É—Ç–µ–π —É–ª—É—á—à–∞–µ—Ç –∞—Å–∏–º–ø—Ç–æ—Ç–∏–∫—É –¥–æ¬†$O(\lg‚Å°ùëõ)$¬†–≤ —Å—Ä–µ–¥–Ω–µ–º. –ó–¥–µ—Å—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ –∞–º–æ—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ ‚Äî –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –≤ —Ö—É–¥—à–µ–º —Å–ª—É—á–∞–µ –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç —Å–∂–∏–º–∞—Ç—å –≤–µ—Å—å –±–∞–º–±—É–∫ –∑–∞¬†$O(n)$.

–î–æ–∫–∞–∂–µ–º —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø—Ä–æ —Ä–∞–Ω–≥–æ–≤—É—é —ç–≤—Ä–∏—Å—Ç–∏–∫—É - –∞ –∏–º–µ–Ω–Ω–æ, —á—Ç–æ —Ä–∞–∑–º–µ—Ä –¥–µ—Ä–µ–≤–∞ —Å –∫–æ—Ä–Ω–µ–º $x$ —Ä–∞–≤–µ–Ω $size(x) \geq 2^{rank[x]}$

–ë–∞–∑–∞ –≤–µ—Ä–Ω–∞ (–ø—Ä–∏ $size(x) = 1$)

–î–∞–ª–µ–µ, –ø–µ—Ä–µ—Ö–æ–¥ –ø—Ä–∏ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–∏

–ü—É—Å—Ç—å $rank[x] > rank[y]$, —Ç–æ–≥–¥–∞:

$size'(x) = size(x) + size(y) \geq 2^{rank[x]} + 2^{rank[y]} \geq 2^{rank[x]} = 2^{rank'[x]}$

–ï—Å–ª–∏ –∂–µ —Ä–∞–Ω–≥–∏ —Ä–∞–≤–Ω—ã, —Ç–æ —Ç–∞–º –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏ –ø–æ–ª—É—á–∞–µ—Ç—Å—è $2^{rank[x] + 1}$



