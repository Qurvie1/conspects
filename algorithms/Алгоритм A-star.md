По сути, это [[Алгоритм Дейкстры|Дейкстра]], но немного улучшенная.

Пусть у нас также есть неотрицательные веса, нам нужно найти $dist(s, t)$

Будем пользоваться свойствами [[Граф|графа]] - например, граф на плоскости 

Пусть на нём можно ввести **эвристику** - для каждой вершины оценивает расстояние до $t$.

Например, на плоскости можно брать евклидово расстояние

$h(v)$ - какая-то легко вычислимая оценка на расстояние.

Пусть $g(v)$ - минимальная найденная длина пути от $s$ до $v$ (то, что в Дейкстре было).

Тогда $f(v) = g(v) + h(v)$ - теперь берём эту функцию и запускаем Дейкстру по ней.

Теперь вопрос - а почему это вообще корректно и какие нужно брать эвристики, чтоб путь был правильным

**Определение.** Эвристика называется допустимой, если $\forall v: h(v) \leq dist(v, t)$ (то есть эвристика - это оценка снизу).

**Определение**. Эвристика называется монотонной, если:

1) $h(t) = 0$
2) Для любого ребра $(u, v)$ с весом $w$: $h(u) \leq h(v) + w$

**Теорема**. Если эвристика $h$ является монотонной, то каждая вершина будет раскрыта не более 1 раза, находит правильный ответ $g[t] = dist(s, t)$ $\implies$ работает не хуже Дейкстры.
Если $h$ является допустимой, то $A*$ точно найдёт правильный ответ, но не факт, что быстро.

**Лемма**. Если эвристика монотонная, то $A*$ раскрывает вершины в порядке неубывания $f$.

Докажем эту лемму.

Пусть происходит раскрытие вершины $v$.

Рассмотрим ребро $(v, u)$. Если $f(u)$ не изменилась и уже посчитана, то $f(v) \leq f(u)$

Если же $f(u)$ изменилась, то $f(u) = g(v) + w + h(u)$

Так как эвристика монотонная, то $h(v) \leq h(u) + w$

Но тогда оценка верна.

Докажем теперь всю теорему.

$f$ - не убывает в куче, тогда каждая вершина раскрывается не более одного раза.

Теперь корректность

Тоже по индукции, база очевидна, предположим противное, то есть что $g[v] > dist(s, v)$ для некоторой вершины $v$, возьмём первую нераскрытую вершину $u$.

Но $g[u]$ определено правильно!

Пусть $dist(s, v) = dist(s, u) + L$

Поскольку эвристика монотонная: $h(u) \leq h(v) + L$

$$
f(u) = g[u] + h(u) = dist(s, u) + h(u) = dist(s, v) - L + h(u) \leq dist(s, v) + h(v) < f(v)
$$
То есть $u$ должна была раскрыться раньше, противоречие.

Примеры эвристик

1) Евклидово расстояние
2) Манхэттенское расстояние
3) Чебышёвская метрика - максимум из расстояний