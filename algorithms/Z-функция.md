По аналогии с [[Префикс-функция|префикс-функцией]]: есть строка и есть функция

Такая, что:

$z_{i}$ - это максимум по всем $k$ таким, что префикс исходной строки длины $k$, совпадает с подстрокой $[i, i + k - 1]$ (то есть старт с $i$ длиной $k$ совпадает с первыми $k$ символами исходной строки).

Аналогично можно выполнить поиск шаблона в строке, то есть также должно быть $z_{i} = |p|$

Алгоритм похождения.

Тоже будем идти по строки слева направо и подсчитывать. Пусть посчитано всё до $z_{i-1}$.

Тогда 