Это по сути просто алгоритм [[Форд-Фалкерсон|Форда-Фалкерсона]] по поиску максимального [[Потоки|потока]].

Просто меняем DFS на BFS и находим **минимальный по числу рёбер** путь.

Тогда асимптотика будет $O(VE^{2})$.

Асимптотики плохие, но на реальных графах обычно работает сильно быстрее.

Докажем, что она достигается вообще когда-то

Лемма 1. Пусть $G_{f}$ и $G_{f'}$ - это 2 последовательных состояний остаточной сети в алгоритме Эдмондса-Карпа.

Пусть $d(v) = dist(s, v)$ в графе $G_{f}$
$d'(v) = dist(s, v)$ в графе $G_{f'}$

Тогда для всех $v$ $d(v') \geq d(v)$ (в целом очевидно, что так как мы берём минимальный по рёбрам путь, то у нас последующий не может быть меньше).

От противного. Пусть для какого-то $v$ расстояние уменьшилось, среди всех этих вершин (где происходит нарушение), выберем $d'(v)$ - минимально.

Путь точно ненулевой, тогда выберем предпоследнюю (перед $v$) вершину $u$.

Тогда $d'(v) = d'(u) + 1$, но так как $d'(v)$ минимально, поэтому для $u$ это не нарушается и $d'(u) \geq d(u)$.

Поймём, откуда $(u, v)$ в $G_{f'}$

Случай 1. Было в $G_{f}$, но тогда очев, что $d(v) \leq d(u) + 1 \leq d'(u) + 1 = d'(v)$, противоречие с изначальным.
Случай 2. $(u, v)$ не было в $G_{f}$, но оно появляется. То есть оно появляется как обратное ребро 
Ну и снова получается, что было обратное ребро, так как $d(v) + 1 = d(u)$ (то есть было ребро $d(v) + 1 = d(u) \leq d'(u) = d'(v) - 1$), опять противоречие.

Лемма 2.
Каждое ребро $(u, v)$ в алгоритме Эдмондса-Карпа насыщается не более чем $O(V)$ раз (насыщается - типа исчерпывается весь поток).

Между двумя последовательными насыщениями мы должны пустить поток по ребру $(v, u)$ (в обратную сторону).

Если мы вдоль него чет протолкнули, то $d(v) = d(u) + 1$ (первый раз), а поскольку мы уже проталкиваем по другому ребру, то расстояние $d'(v) \geq d(u) + 1$ и потом уже $d'(u) \geq d(u) + 2$

То есть мы увеличили расстояние между двумя последовательными насыщениями не может быть больше чем примерно $\frac{V}{2} = O(V)$

Следствие. Алгоритм Эдмондса-Карпа корректен и работает за $O(VE^2)$

Почему такое время? Каждая итерация насыщает хотя бы одно ребро, но каждое ребро (их $E$) насыщается $O(V)$ раз, то итераций $O(VE)$ (столько насыщений), ну а каждая итерация - это BFS, поэтому $O(VE^{2})$

Как можно это ускорить - **техника масштабирования**.

Идея: пусть $C$ - ограничение сверху на все $cap$ и нет кратных рёбер.

Будем пытаться пускать потоки наибольшей степенью двойки, не превосходящей $C$. Если на ребре пропуск больше 128, то будем считать, что пропуск 128, если меньше, то 0.

Останется, что всё ребра 128 либо 0, поделим на 128, найдём ответ и умножим его на 128.
Потом спустимся на 64 и будем пускать такие же, только если у нас ребро 128, то представим его как 64 * 2

Асимптотика $O(E^{2}\lg C)$
