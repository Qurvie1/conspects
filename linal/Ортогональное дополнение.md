Пусть у нас есть какое-то подпространство [[conspects/linal/Евклидовы пространства|евклидова пространства]] $E' \subset E$

Тогда $E^{\perp}$ - **ортогональное дополнение** к $E'$, если $\forall x \in E', \forall y \in E^{\perp} \implies (x, y) = 0$
(про перпендикулярность написано [[Ортогональные векторы|тут]] и [[Длина и угол вектора|тут]]).

Например - плоскость и её ортогональное дополнение - это прямая

Причём $E$ - прямая сумма дополнения и не дополнения.

Как его искать? Пусть $E'$ дано в виде линейной оболочки $<a_{1}, .., a_{k}>$

Если $x$ - в дополнении, то

$$
\begin{cases}
(a_{1}x) = 0 \\
. \\
. \\
. \\
(a_{k}x) = 0
\end{cases}
$$
или (в ОНБ, не в ОНБ там нужно лишь таскать с собой [[conspects/linal/Евклидовы пространства|матрицу Грама]])$$\begin{cases}
a_{1}^{T}x = 0 \\
. \\
. \\
. \\
a_{k}^{T}x = 0
\end{cases}$$
$\Phi = (a_{1}, ..., a_{k})$ (просто матрица, не фундаментальная)

Тогда нужно будет решить систему
$\Phi^{T}x = 0$ - система для нахождения дополнения (просто переписали вторую систему).

Задача.
Пусть пространство $E = <a_{1}, a_{2}>$
$a_{1} = \begin{pmatrix}1 & -5 & 1\end{pmatrix}^{T}$, $a_{2}=  \begin{pmatrix}-1  & 1 & 1\end{pmatrix}^{T}$

То есть просто выписываем в строчку:

$\begin{pmatrix}1 & -5 & 1 \\ -1 & 1 & 1\end{pmatrix}x = 0$, $x = \begin{pmatrix}3 \\ 1 \\ 2\end{pmatrix}c$

Задача
$L$ задано системой $Ax = 0$

$A = \begin{pmatrix}2 & 5 & 0 \\ 1 & 2 & 1 \\ -1 & -4 & 3\end{pmatrix}$

Найдём собственно базисные векторы, для этого решим систему.

$\begin{pmatrix}2 & 5 & 0 \\ 1 & 2 & 1 \\ -1 & -4 & 3\end{pmatrix} \implies \begin{pmatrix}2 & 5 & 0 \\ 1 & 2 & 1 \\ 0 & -2 & 4\end{pmatrix} \implies \begin{pmatrix}2 & 5 & 0 \\ 1 & 2 & 1 \\ 0 & -1 & 2\end{pmatrix} \implies \begin{pmatrix}2 & 5 & 0 \\ 0 & -1 & 2 \\ 0 & 1 & -2\end{pmatrix} \implies \begin{pmatrix}2 & 5 & 0 \\ 0 & 1 & -2 \\ 0  & 0 & 0\end{pmatrix}$

Тогда [[Фундаментальная матрица|ФСР]] : $\Phi = \begin{pmatrix}5 \\ -2 \\ -1\end{pmatrix}$, $L = <\begin{pmatrix}5 \\ -2 \\ -1\end{pmatrix}>$
Тогда чтоб найти $L^{\perp}$

$\Phi^{T}x = 0 \implies \Phi^{T} = \begin{pmatrix}2 & -1 \\ 5 & 0 \\ 0 & 5\end{pmatrix}$
Заметим, что базисные вектора составляющие ортогональное дополнение - это просто первая строчка из $A$ + линейная комбинация 2 и 3 из $A$ (линейно зависимых).

Почему так?

Решая систему $Ax = 0$ мы находим $A\Phi = 0$, потом мы транспонируем ФСР и получаем уравнение $\Phi^{T}x = 0$, но его решение - это как раз $A\Phi = 0 \implies \Phi^{T}A^{T} = 0$ (то есть просто $A^{T}$)

Поэтому можно просто выписать $A^{T}$ и потом убрать ЛЗ вектора

Как нам помогает ортогональное дополнение
Даны 2 вектора, нужно достроить до ОНБ

Мы брали эти 2 вектора и берём стандартный базис (первые 2 столбика - это данные векторы).

$\begin{pmatrix}1 & -1 & 1 & 0 & 0 & 0 & 0 \\ 2 & 0 & 0 & 1 & 0 & 0 & 0 \\ -1 & 1 & 0 & 0 & 1 & 0 & 0 \\ 3 & 1 & 0 & 0 & 0 & 1 & 0 \\ 1 & -1 & 0 & 0 & 0 & 0 & 1\end{pmatrix}$

Ну и далее мы приводим к ступенчатому виду, чтоб понять какие ЛЗ с данными, а какие нет. Какие ЛНЗ - то и будет дополнением до базиса.
Поскольку у нас требуется ОНБ, а у нас есть просто базис, то можно провести [[Процесс ортогонализации Грама-Шмидта|ортогонализацию]].

Но как это можно сделать проще? Взять эти 2 вектора и построить ортогональное дополнение к ним (получить 3 вектора и применить ортогонализацию уже к ним).

Найдём:

$L^{\perp} : \begin{pmatrix}1 & 2 & -1 & 3 & 1 \\ -1 & 0 & 1 & 1 & -1\end{pmatrix}x = 0 \implies \begin{pmatrix}1 & 0 & -1 & -1 & 1 \\ 0 & 1 & 0 & 2 & 0\end{pmatrix}x = 0$

$\Phi^{\perp} = \begin{pmatrix}1 & 1 & -1 \\ 0 & -2 & 0 \\ 1 & 0 & 0 \\ 0 & 1 & 0 \\ 0 & 0 & 1\end{pmatrix}$ - это и будут 3 вектора, задающих пространство и применим к ним ортогонализацию:

$$b_{1} = a_{1} = \begin{pmatrix}1 \\ 0 \\ 1 \\ 0 \\ 0\end{pmatrix}$$

$$b_{2} = a_{2} - \frac{(a_{2}, b_{1})}{(b_{1}, b_{1})}b_{1} = \begin{pmatrix}1 \\ -2 \\ 0 \\ 1 \\ 0\end{pmatrix} - \frac{1}{2}\begin{pmatrix}1 \\ 0 \\ 1 \\ 0 \\ 0\end{pmatrix} = \frac{1}{2}\begin{pmatrix}1 \\ -4 \\ -1 \\ 2 \\ 0\end{pmatrix}$$
$$b_{3} = a_{3} - \frac{(a_{3}, b_{1})}{(b_{1}, b_{1})}b_{1} - \frac{(a_{3}, b_{2})}{(b_{2}, b_{2})}b_{2} = \begin{pmatrix}-1 \\ 0 \\ 0 \\ 0 \\ 1\end{pmatrix} + \frac{1}{2}\begin{pmatrix}1 \\ 0 \\ 1 \\ 0 \\ 0\end{pmatrix} + \frac{1}{22}\begin{pmatrix}1 \\ -4 \\ -1 \\ 2 \\ 0\end{pmatrix} = \frac{1}{22}\begin{pmatrix}-10 \\ -4 \\ 10 \\ 2 \\ 22\end{pmatrix}$$
Теперь нужно лишь отнормировать и мы получили ОНБ.

