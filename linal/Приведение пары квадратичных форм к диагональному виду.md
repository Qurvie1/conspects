Раньше мы приводили к [[Приведение квадратичной формы к каноническому виду|каноническому]] виду 1 форму, а теперь нам нужно сразу 2 привести.

**Теорема**. Для пары квадратичных форм, таких, что одна положительно определена, а вторая произвольная, существует ОНБ, в котором положительно определённая имеет канонический вид (единичная матрица), а вторая диагональная.

Общая теорема. Если среди линейных комбинаций [[Квадратичные формы (семинар)|квадратичных форм]] есть положительно определённая, то существует ОНБ, в котором обе диагональны.

Отсюда если одна из них отрицательно определённая, то тоже можно, так как $-f$ положительно определённой будет

Теперь будем приводить к диагональному виде обе.

1 способ:

Пусть $f - F$, $g_{+} - G_{+}$ (матрицы справа).

Они в линейном пространстве, введём скалярное произведение такое, что $\Gamma = G_{+}$ ([[conspects/linal/Евклидовы пространства|матрица Грама]]).

Так как она положительно определена, то всё окей.

$F$ - это матрица квадратичной формы

Матрица [[Билинейные формы в евклидовых пространствах|присоединённого преобразования]] находится как $A = \Gamma^{-1}B$

Тогда если мы А - диагонализируем и переходим в ОНБ, то $\Gamma = E$

То есть находим [[Собственные векторы|собственные вектора]].

Тогда: $det(A - \lambda E) = det(G^{-1}F - \lambda E) = det G^{-1} det(F - \lambda G)$

Тогда можно решать $det (F - \lambda G) = 0$

Потом мы берём $h_{i}$ и их нормируем, но матрица Грама нетривиальная, поэтому:
$(h_{i}, h_{i}) = h_{i}^{T}G_{+}h_{i}$

В таком случае будет

$$
G = E, F = diag(\lambda_{1}, ..., \lambda_{k}), S = (h_{1}, h_{2}, ...)
$$

Пример:

$g(x) = x_{1}^{2} + 2x_{1}x_{2} + 3x_{2}^{2}$
$f(x) = 4x_{1}^{2} + 16x_{1}x_{2} + 6x_{2}^{2}$

Определяем какая из них [[Исследование знака квадратичной формы|положительно определённая]].

$G$ - положительно опр. по кр. Сильвестра.

Теперь считаем $det(F - \lambda G) = 0$

$$
\begin{vmatrix}4-\lambda & 8-\lambda \\ 8-\lambda & 6-3\lambda\end{vmatrix} = 0
$$
(вычитаем из КАЖДОЙ лямбду).

$\lambda_{1} = 5, \lambda_{2} = -4$

1) $\lambda_{1} = 5$, тогда $h_{1} = \begin{pmatrix}3 \\ 1\end{pmatrix}$
2) $\lambda_{2} = -4$, тогда $h_{2} = \begin{pmatrix}3 \\ -2\end{pmatrix}$

Проверим, что они реально ортогональны
$$
(h_{1}, h_{2}) = \begin{pmatrix}3 & 1\end{pmatrix}\begin{pmatrix}1 & 1 \\ 1 & 3\end{pmatrix}\begin{pmatrix}3 \\ -2\end{pmatrix} = 0
$$
То есть всё хорошо посчитали

Теперь посчитаем:

$(h_{1}, h_{1}) = 18$

$(h_{2}, h_{2}) = 9$

Теперь переходим в ОНБ:

$$
e_{1} = \frac{1}{3\sqrt{2}}\begin{pmatrix}3 \\ 1\end{pmatrix}, e_{2} = \frac{1}{3}\begin{pmatrix}3 \\ -2\end{pmatrix}, G = \begin{pmatrix}1 & 0 \\ 0 & 1\end{pmatrix}, F = \begin{pmatrix}5 & 0 \\ 0 & -4\end{pmatrix}, S = \begin{pmatrix}- \frac{1}{\sqrt{2}} & 1 \\ \frac{1}{3\sqrt{2}} & - \frac{2}{3}\end{pmatrix}
$$
Собственно, $e_{1}$ и $e_{2}$ - это базис, а это матрицы после перехода в этот базис.

Алгоритм 2:

Пусть у нас опять же $G_{+}$, $F$

Мы можем элементарными преобразованиями привести $G$ к единичной матрице и то же самое делать со второй матрицей ($F$).

Тогда у нас $G$ - будет единичной, то есть мы в ОНБ, а потом мы находим собственные вектора $F$, диагонализируем и переходим в другой ОНБ.

При этом мы не испортим $G$, так как матрица ортогональной будет.

Сделаем это с этой же задачей:

$$
G_{+} = \begin{pmatrix}1 & 1 \\ 1 & 3\end{pmatrix}, F = \begin{pmatrix}4 & 8 \\ 8 & 6\end{pmatrix}
$$
Опять же, приводим как [[Приведение квадратичной формы к каноническому виду|вот тут]].

$$
\begin{pmatrix}1 & 1 \\ 1 & 3\end{pmatrix} \rightarrow \begin{pmatrix}1 & 1 \\ 0 & 2\end{pmatrix} \rightarrow \begin{pmatrix}1 & 0 \\ 0 & 2\end{pmatrix}
$$
$$
\begin{pmatrix}4 & 8 \\ 8 & -6\end{pmatrix} \rightarrow \begin{pmatrix}4 & 8 \\ 4 & -2 \end{pmatrix} \rightarrow \begin{pmatrix}4 & 4 \\ 4 & -6\end{pmatrix}
$$
Потом делим и строчку, и столбец на $\sqrt{2}$

И получаем итого:

$$
F' = \begin{pmatrix}4 & 2\sqrt{2} \\ 2\sqrt{2} & -3\end{pmatrix}
$$
Находим собственные вектора, ортогонализируем и всё хорошо.

Если обе положительно определённые, то берём любые.

Вернёмся к теореме про линейные комбинации квадратичных форм.

Пусть $h = \alpha f + \beta g$

Тогда $h$ можно взять за положительно определённую и за матрицу Грама, а матрицу $G$ - за матрицу квадратичной формы.

Тогда приведём их к диагональному и если $\alpha \ne 0$, то $f = \frac{1}{\alpha} h - \frac{\beta}{\alpha}g$
Ну линейная комбинация диагональных диагональна.
