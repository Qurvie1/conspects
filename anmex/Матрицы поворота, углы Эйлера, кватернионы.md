По сути, с этими вещами мы задаём положение твёрдого тела.

Пусть $\vec{r}, \vec{v}$ - движение центра масс.

Знаем кинематическую связь $\dot{\vec{r}} = \vec{v}$

Тело вращается, поэтому нужна угловая скорость $\vec{w}$ - это аналог обычной скорости.

Аналогом $\vec{r}$ у нас будет $A, (\psi, \theta, \phi), \Lambda$

Начнём с простого - с матриц перехода (поворота).

Пусть у нас есть базис $[i]$ нам нужно перейти в $[e]$ базис.

Это столбцы нового базиса в старом (типа $A(i_{1})$)

Тогда очевидно, что:
$$
\vec{e_{k}} = A\vec{i_{k}}
$$
Ну и по сути в матрице стоит следующее:
$$
A = \begin{pmatrix}(\vec{i_{1}}, \vec{e_{1}}) & (\vec{i_{1}}, \vec{e_{2}}) \end{pmatrix}
$$
Ну и так далее

Допустим, нам надо найти как меняется базис, тогда мы хотим продифференцировать, но из уравнения Пуассона мы знаем, что:
$$
\dot{e_{k}} = \vec{w} x \vec{e_{k}}
$$
Но неудобно домножать каждый раз на столбец $w$, поэтому вводится следующий объект:
$$
[\vec{w}]_{x} = \begin{pmatrix}0 & -w_{3} & w_{2} \\ w_{3} & 0 & -w_{1} \\ -w_{2} & w_{1} & 0\end{pmatrix}
$$
Это всё делается, чтоб выполнялость следующее:
$$
\vec{a} x \vec{b} = A\vec{b}
$$
Тогда матрица $A$ - это и есть $[a]_{x}$

В таком случае, мы можем записать это всё следующим образом:
$$
\dot{A} = [\vec{w}]_{x}(\vec{e_{1}}, \vec{e_{2}}, \vec{e_{3}}) = [\vec{w}]_{x}A
$$
$w$ берётся в ИСК (исходной)

В связанной (то есть уже другой), то будет:
$$
\dot{A} = A[\vec{w}^{ССК}]
$$
$$
\vec{w^{ИСК}} = A\vec{w^{ССК}}
$$
Теорема Эйлера

Поскольку у нас матрица ортогональна, то у неё есть 3 собственных значения:

$$
\lambda_{1} = 1, \lambda_{2,3} = \cos \alpha \pm i \sin \alpha
$$
А что инвариантно при преобразованиях - след матрицы

Тогда:
$$
1 + 2\cos \alpha = tr A
$$

Тогда угол мы можем найти:
$$
\alpha = \pm \arccos (\frac{tr A - 1}{2})
$$
И вот интересно, что тут есть +- угол, то есть нужно понять в какую сторону мы вращаемся.

Нужно показать, как мы можем определить угол вращения.

Теперь исследуем углы Эйлера. Это 3 конкретных угла

$$
3 - 1' - 3''
$$
Это 3 конкретных поворота:

Первый - на угол $\psi$ вокруг $i_{3}$

Второй - на угол $\theta$ вокруг новой оси $\vec{i_{1}}'$

Третий - на угол $\phi$ вокруг $\vec{i_{3}''} = \vec{e_{3}}$

Теперь мы можем получить угловую скорость соответственно:
$$
\vec{w} = \dot{\vec{\psi}} + \dot{\vec{\theta}} + \dot{\vec{\phi}}
$$
В связанной системе координат:
$$
\vec{w} = (p, q, r)
$$
$$
\dot{\vec{\phi}} = \dot{\phi} \begin{pmatrix}0 \\ 0 \\ 1\end{pmatrix}
$$
$$
\dot{\vec{\theta}} = \dot{\theta}\begin{pmatrix}\cos \phi \\ -\theta \sin \phi \\ 0\end{pmatrix}
$$
$$
\dot{\vec{\psi}} = \dot{\psi}\begin{pmatrix}\sin \theta \sin \phi \\ \sin \theta \cos \phi \\ \cos \theta\end{pmatrix}
$$
Теперь, если мы это сложим, то по сути получим как раз $(p, q, r)$

$$
\begin{cases}
p = \dot{\theta} \cos \phi + \dot{\psi} \sin \theta \sin \phi \\
q = -\dot{\theta} \sin \phi + \dot{\psi}\sin \theta \cos \phi \\
r = \dot{\phi} + \dot{\psi}\cos \theta
\end{cases}
$$
Отсюда можем выразить всё остальное:
$$
\begin{cases}
\dot{\psi} = \frac{p \sin \phi + q\cos \phi}{\sin \theta} \\
\dot{\theta} = p \cos \phi - q \sin \phi \\
\dot{\phi} = r - ctg \theta (p\sin \phi + q \cos \phi)
\end{cases}
$$
В чём трабл - у углов есть вырождение, так как у нас в знаменателе углы + много конфигураций.

Кватернионы

$$
\Lambda = \lambda_{0} + \lambda_{1} \vec{i_{1}} + \lambda_{2}\vec{i_{2}} + \lambda_{3} \vec{i_{3}}
$$
У него есть скалярная часть + векторная часть

Всё работает

Если $|\Lambda| = 1$, то это кватернион поворота, то он задаёт

Тогда:
$$
\Lambda = \begin{pmatrix}\cos \frac{\phi}{2} \\ \vec{e} \sin \frac{\phi}{2}\end{pmatrix}
$$
Это поворот вокруг оси $e$ на угол $\frac{\phi}{2}$

Тут удобно складывать повороты

Допустим мы из $i$ базиса поворачиваем в $j$ с $\Lambda$, а потом на $N$ в базис $e$

2 способа интерпретации 

Если мы смотрим в инерциальном изначальном базисе каком-то, то это просто

$$
M = N \Lambda
$$
Если же мы записываем кватернионы в собственном базисе, то есть записываем $\Lambda$ в $i$ базисе

$$
M^{*} = \Lambda^{*} N^{*}
$$
И тут уже прямая последовательность!


