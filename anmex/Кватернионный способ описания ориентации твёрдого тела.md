Рассмотрим линейное векторное пространство в $4D$.

Хотим ещё добавить умножение по сути, у нас должна быть ассоциативность, дистрибутивность, ну и линейность вынесения множителя.

Кватернион:
$$
K = \lambda_{0} \vec{i_{0}} + \lambda_{1} \vec{i_{1}} + \lambda_{2} \vec{i_{2}} + \lambda_{3} \vec{i_{3}}
$$
Введём умножение для базисных векторов:
$$
i_{0} * i_{k} = i_{k} * i_{0} = i_{k}, k = 0, 1, 2, 3
$$
$$
i_{k} * i_{k} = - i_{0}, k = 1, 2, 3
$$
$$
i_{1} * i_{2} = i_{3}, i_{2} * i_{3} = i_{1}, i_{3} * i_{1} = i_{2}
$$
$$
i_{2} * i_{1} = - i_{3}, i_{3} * i_{2} = -i_{1}, i_{1} * i_{3} = - i_{2}
$$
Интерпретация.

Пусть $l_{0}$ - вещественная единица.
$$
i_{1}, i_{2}, i_{3} - орты, базиса3d
$$
Тогда определим:
$$
i_{k} * i_{l} = \vec{i_{k}} x \vec{i_{l}}, k = 1, 2, 3
$$
То есть векторно домножаем

Тогда $i_{k} * i_{k} = -1$

Таким образом кватернион - это скалярная часть и векторная часть в трёхмерном базисе каком-то:
$$
K = \lambda_{0} + \vec{\lambda}
$$
Как мы их тогда перемножаем?
$$
L = \lambda_{0} + \vec{\lambda}, M = \mu_{0} + \vec{\mu}
$$
$$
L * M = \lambda_{0} \mu_{0} - \vec{\lambda} * \vec{\mu} + \lambda_{0} \vec{\mu} + \mu{0} \vec{\lambda} + \vec{\lambda} x \vec{\mu}
$$
Тогда можем определить:

1) Сопряжённый к $L$: $\bar{L} = \lambda_{0} - \vec{\lambda}$
2) Норма: $||L|| = L \bar{L} = \lambda_{0}^{2} + \lambda_{1}^{2} + \lambda_{2}^{2} + \lambda_{3}^{2}$
3) Модуль - корень из нормы.

Определение. Обратный кватернион к $L = \lambda_{0} + \vec{\lambda}$.

$$
L^{-1} = \frac{\bar{L}}{||L||}
$$
Ну и в произведении получаем просто вещественную единицу.

Утверждение:
$$
\bar{L * M} = \bar{M} * \bar{L}
$$
Другое утверждение:
$$
||L * M|| = ||L|| * ||M||
$$

Переходим к дифференцированию кватернионов:
$$
\dot{\Lambda} = \frac{1}{2}w^{ИСК} * \Lambda
$$
$$
\dot{\Lambda} = \frac{1}{2}\Lambda * w^{ССК}
$$
Это в целом аналогично с тем, что:
$$
\dot{A} = A[w^{ССК}]_{x}
$$
$$
\dot{\vec{e_{i}}} = \vec{w} x \vec{e_{i}}
$$
Это всё одинаковые соотношения

Чем хороши? 4 уравнения 

$[i] \rightarrow \Lambda_{1} [j] \rightarrow \Lambda_{2} [e]$

Это если повороты заданы в одном базисе (в $i$-том).

Итого получаем, что:
$$
\Lambda = \Lambda_{2} \Lambda_{1}
$$
Повороты заданы как:
$$
\Lambda = \begin{pmatrix}\cos \frac{\phi}{2}  \\ \vec{e}\sin \frac{\phi}{2}\end{pmatrix}
$$
Вокруг $\vec{e}$ на угол $\phi$

А если повороты заданы в своих системах:
$$
[i] \rightarrow N_{1} [j] \rightarrow N_{2} [e]
$$
То есть если $N_{1}, N_{2}$ - заданы в СК ИЗ которой совершается поворот, тогда они перемножаются в прямом порядке:
$$
N = N_{1} * N_{2}
$$
Тогда параметры кватерниона - это параметры Родрига-Гамильтона.

Допустим, у нас вращается конус

Тогда мы переходим из ИСК в ПСК и потом в ССК

Тогда мы сначала поворачиваемся вокруг $z$ на угол
$$
\psi = \int \Omega(t)dt
$$
Аналогично вокруг $y'$
$$
\Theta = \int w(t)dt
$$
Тогда можно задать векторы в своих базисах:
$$
\Lambda_{1} = \begin{pmatrix}\cos \frac{\phi}{2} \\ \begin{pmatrix}0 \\ 0 \\ 1\end{pmatrix} \sin \frac{\phi}{2}\end{pmatrix}
$$
А второй кватернион будет:
$$
\Lambda_{2} = \begin{pmatrix}\cos \frac{\Theta}{2} \\ \begin{pmatrix}0 \\ \frac{\sqrt{2}}{2} \\ \frac{\sqrt{2}}{2}\end{pmatrix} \sin \frac{\Theta}{2}\end{pmatrix}
$$
Тогда кватернион поворота (общий) будет:
$$
\Lambda = \Lambda_{1} * \Lambda_{2}
$$